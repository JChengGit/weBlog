第一部分：Install

一、创建数据库
创建数据库
createdb weibo
进入数据库
psql weibo
创建表
\i tables.sql
\q

二、运行

将源文件拷到某个目录解压，有三种运行方式，任选一种使用：

1,直接运行
安装依赖包
pip install -r requirements.txt
启动
python server.py

2,使用venv
创建并启动虚拟环境
python3 -m venv venv
. venv/activate
安装依赖包
pip install -r requirements.txt
启动
python server.py

3,使用docker
创建images
docker build -t weibo .
启动
docker run --net=host weibo

启动后进入127.0.0.1:5000即可访问



第二部分：Source Code Document

1,关于数据库
使用python的包psycopg2连接数据库
数据库建表代码存在tables.sql里
使用trigger完成各种各种计数，关联删除

2,关于server.py
注册，路由为 /register
调用create_user（），用邮箱和用户名进行注册，进行各种输入检查
调用validate_email（），用正则表达式判断邮箱格式合法，
密码使用md5进行哈希(hash)

登录，路由为 /login
调用user_login（）登录，进行各种输入检查
登录后，使用session对象保持登录，储存用户id

主页，路由为 /community
进行sql查询将自己和关注者的微博、评论、点赞信息展示出来
提供textarea输入自己的微博
在 /post路由下接收自己发表的微博写入数据库
在 /post/like路由下接收点赞信息写入数据库
在 /post/update路由下接收修改微博信息写入数据库
在 /post/delete路由下删除数据库中的微博
在 /comment路由下接收评论信息写入数据库
在 /comment/like路由下接收评论点赞信息写入数据库
在 /comment/update路由下接收修改评论信息写入数据库
在 /comment/delete路由下删除数据库中的评论

关注，路由为/find和follow
实现关注和取关

设置，路由为/setting
修改密码，注销用户


3,关于前端UI
使用HTML/CSS/JavaScript完成界面设计，未使用任何模板
使用AJAX实现点赞与后端交互时，不刷新页面显示结果
使用flask框架下render_template()方法显示前端界面
HTML模板存放于 templates/ 目录下
CSS文件存放于 static/ 目录下

4,关于unittest
serverCopy.py是server.py的副本，唯一不同处在于serverCopy.py连接testdb数据库
进行单元测试时，先创建测试数据库
createdb testdb
psql testdb
\i tables.sql
\q
运行unittest
python serverTest.py





